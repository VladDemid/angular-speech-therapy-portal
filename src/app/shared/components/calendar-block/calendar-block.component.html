<div class="calendar">
   <div class="calendar-wrapper">
      <div class="calendar-header">
         <div class="arrow arrow-left" id="prev-month-arrow" (click)="decreaseMonth()"></div>
         <div class="month">{{monthName}} {{year}}</div>
         <div class="arrow arrow-right" id="next-month-arrow" (click)="increaseMonth()"></div>
      </div>
      <div class="calendar-body">
         <div class="days-of-week">
            <div *ngFor="let dayName of daysOfWeek" class="day-of-week">
               {{dayName}}
            </div>
         </div>
         <div class="days">
            <div *ngFor="let dayIndex of daysArr; index as i"
               
               class="day">
               <app-calendar-day [dayIndex] = "i+1" [currentFirstDay]="currentFirstDay" 
               [todayDay]="day" [currentMonth]="currentMonth" [month]="month" [year]="year" 
               [currentYear]="currentYear" [selectedDay]="selectedDay" [doctorShedule]="doctorShedule" 
               [doctorsLessons]="doctorsLessons" [isCalendarPage]="isCalendarPage"  
               (outDay)="onOutDay($event)" (click)="onDayClick(i+1)"></app-calendar-day>
            </div>
         </div>
         <!-- isCalendarPage: {{isCalendarPage}}
         month: {{month}} <br>
         начало месяца с: {{currentFirstDay}} <br>
         выбранный день: {{selectedDay+1}} <br>
         выбранный час: {{selectedHourForLesson}} -->
      </div>
   </div>
   <!-- для страницы карточки доктора (не календарь) -->
   <div class="time-aside time-aside-view" *ngIf="!isCalendarPage">
      <div class="day-not-chosen-sign" *ngIf="selectedDay == -1 || (selectedDay != -1 && !doctorShedule[year][month][selectedDay+1])">
         для просмотра
         <div class="time-blocker">
            День не выбран, либо доктор не работает в выбранный день
            <div class="example">
               <div class="not-working-color color-example"></div>
               <p> - не рабочие дни доктора</p>
            </div>
            <div class="example">
               <div class="working-color color-example"></div>
               <p> - рабочие дни доктора</p>
            </div>
            <div class="example">
               <div class="choosen-day-color color-example"></div>
               <p> - выбранный день</p>
            </div>
         </div>
      </div>
      <div class="day-chosen" *ngIf="selectedDay != -1 && doctorShedule && doctorShedule[year] && doctorShedule[year][month] && doctorShedule[year][month][selectedDay+1]">
         <div class="time-selection">
            <div class="time-row" 
            [ngClass]="{'work-hour': doctorShedule && doctorShedule[year] && doctorShedule[year][month] && doctorShedule[year][month][selectedDay+1] && doctorShedule[year][month][selectedDay+1][time], 
                        'selected-hour': selectedHourForLesson == time}"
            *ngFor="let time of workHoursArray; index as i" >
               <div class="time-row-inner" (click)="onClickTimeRow(time)">
                  <div class="period">
                     {{time | timeRow}} 
                  </div>
                  <div class="patient" *ngIf="doctorsLessons && doctorsLessons[year] && doctorsLessons[year][month] && doctorsLessons[year][month][selectedDay+1] && doctorsLessons[year][month][selectedDay+1][time]">
                     <!-- {{doctorsLessons[year][month][selectedDay+1][time].name}} -->
                     <div class="busy-sign" *ngIf="doctorsLessons[year][month][selectedDay+1][time].name != (userData.myData.name + ' ' + userData.myData.surname)">
                        Занято
                     </div>
                     <div class="busy-myself-sign" *ngIf="doctorsLessons[year][month][selectedDay+1][time].name == (userData.myData.name + ' ' + userData.myData.surname)">
                        моя запись
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
         <button [routerLink]="['/profile/doctors']" *ngIf='isInProfileModule == "false"'>Перейти в личный кабинет для записи</button>
         <button [disabled]="selectedHourForLesson == -1" (click)="makeAnAppointment(year, month, selectedDay+1, selectedHourForLesson)" *ngIf='isInProfileModule == "true"'>Записаться</button>
         <div class="doctor-alert">
         </div>
      </div>
   </div>
   <!-- для страницы календаря -->
   <div class="time-aside time-aside-edit" *ngIf="isCalendarPage" [ngClass]="{'downloading': updatingdWorkHourData}">
      <div class="time-aside-doctor" *ngIf="userData.myData.userType == 'doctor'">
         <div class="day-not-chosen-sign" *ngIf="selectedDay == -1">
            Пожалуйста выберите день
            <div class="time-blocker">
               <div class="example">
                  <div class="not-working-color color-example"></div>
                  <p> - ваши не рабочие дни</p>
               </div>
               <div class="example">
                  <div class="working-color color-example"></div>
                  <p> - ваши рабочие дни</p>
               </div>
               <div class="example">
                  <div class="choosen-day-color color-example"></div>
                  <p> - выбранный день</p>
               </div>
            </div>
         </div>
         <div class="day-chosen" *ngIf="selectedDay != -1">
            Мои часы работы:
            <div class="time-selection">
               <div class="time-row" 
               [ngClass]="{'work-hour': doctorShedule && doctorShedule[year] && doctorShedule[year][month] && doctorShedule[year][month][selectedDay+1] && doctorShedule[year][month][selectedDay+1][time] && doctorShedule[year][month][selectedDay+1][time]['workTime'] == true, 
                           'lesson-appointed': doctorsLessons && doctorsLessons[year] && doctorsLessons[year][month] && doctorsLessons[year][month][selectedDay+1] && doctorsLessons[year][month][selectedDay+1][time]}"
               *ngFor="let time of workHoursArray; index as i" >
                  <div class="time-row-inner" (click)="onClickTimeRow(time)">
                     <div class="period">
                        {{time | timeRow}} 
                     </div>
                     <div class="patient" *ngIf="doctorsLessons && doctorsLessons[year] && doctorsLessons[year][month] && doctorsLessons[year][month][selectedDay+1] && doctorsLessons[year][month][selectedDay+1][time]">
                        {{doctorsLessons[year][month][selectedDay+1][time].name | nameRow}}
                     </div>
                  </div>
               </div>
            </div>
            *чтобы выбрать часы работы - выберите любую строчку
         </div>
      </div>
      <div class="time-aside-client" *ngIf="userData.myData.userType == 'client'">
         <div class="no-lessons-sign" *ngIf="!userData.myData.lessons">
            у вас пока нет занятий
         </div>
         <div class="my-lessons" *ngIf="userData.myData.lessons">
            Текущие:
            <div class="lesson-card" *ngFor="let item of userData.myData.lessons | lessonsView:currentYear:currentMonth:day:currentHour">
               <p>
                  {{item.day}}-{{monthsNamesWhomCase[item.month]}}
                  {{item.hour | timeRow}}
                  Специалист: {{item.name}}
               </p>
            </div>
         </div>
      </div>
   </div>
</div>
<!-- UPDATING: {{updatingdWorkHourData}} -->
<!-- {{doctorShedule | json}} -->
